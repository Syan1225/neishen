<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.jeecg.modules.fms.reimburse.biz.mapper.UnfiyWorkItemMapper">

<!-- 通过<resultMap>映射实体类属性名和表的字段名对应关系 -->
	<resultMap id="unifyWorkItemVO" type="org.jeecg.modules.fms.reimburse.biz.utils.VO.UnifyWorkItemVO">
	   <!-- result属性映射非匹配字段 -->
	    <result column="apply_no" property="applyNo"/>
	    <result column="create_time" property="createTime"/>
	    <result column="reimbursement_template_code" property="rmbsTemplateCode"/>
	    <result column="reimbursement_template_name" property="rmbsTemplateName"/>
	    <result column="user_name" property="userName"/>
	    <result column="user_depart_name" property="userDepartName"/>
	    <result column="proc_state" property="procState"/>
		<result column="import_erp_status" property="importERPStatus"/>
		<result column="reimbursement_item" property="reimbursementItem"/>
		
	</resultMap>
	<select id="selectUnifyWorkItemByUser" parameterType="java.lang.String" resultMap="unifyWorkItemVO">
		SELECT 
			m.apply_no,m.create_time,m.reimbursement_template_code,m.reimbursement_template_name,m.user_name,
			m.user_depart_name,m.proc_state,ext.import_erp_status,m.reimbursement_item
	    FROM reimburse_biz_main_info m,reimburse_biz_main_info_eprpro_stat_extend ext
 		WHERE 
 			m.apply_no=ext.apply_no
 		AND	m.user_id = #{userCode}
 		<if test="applyNo != null and applyNo !=''">
 			AND	m.apply_no = #{applyNo}
 		</if>
 		<if test="reimbursementItem != null and reimbursementItem !=''">
 			AND	m.reimbursement_item like CONCAT('%', #{reimbursementItem}, '%')
 		</if>
 		AND	m.submit_time is not null
	</select>
	
	
</mapper>